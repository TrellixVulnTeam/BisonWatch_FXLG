import { autodetectByMap, makeByMap, isMatch } from './innerJoin.js';

function fullJoin(itemsToJoin, options) {
  const _fullJoin = (items) => {
    const byMap = (options == null ? void 0 : options.by) == null ? autodetectByMap(items, itemsToJoin) : makeByMap(options.by);
    const matchMap = new Map();
    const joined = items.flatMap((d) => {
      const matches = itemsToJoin.filter((j) => {
        const matched = isMatch(d, j, byMap);
        if (matched) {
          matchMap.set(j, true);
        }
        return matched;
      });
      return matches.length ? matches.map((j) => ({...d, ...j})) : d;
    });
    for (const item of itemsToJoin) {
      if (!matchMap.has(item)) {
        joined.push(item);
      }
    }
    return joined;
  };
  return _fullJoin;
}

export { fullJoin };
//# sourceMappingURL=fullJoin.js.map
